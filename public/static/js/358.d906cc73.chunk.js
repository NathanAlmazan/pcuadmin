"use strict";(self.webpackChunktracetemp=self.webpackChunktracetemp||[]).push([[358],{24358:function(e,n,t){t.r(n),t.d(n,{default:function(){return oe}});var r=t(74165),a=t(15861),i=t(70885),s=t(72791),l=t(66934),o=t(34663),c=t(28029),u=t(63466),d=t(5403),h=t(80184),p=(0,l.ZP)(o.Z)((function(e){return{height:96,display:"flex",justifyContent:"space-between",padding:e.theme.spacing(0,1,0,0)}})),f=(0,l.ZP)(c.Z)((function(e){var n=e.theme;return{width:300,transition:n.transitions.create(["box-shadow","width"],{easing:n.transitions.easing.easeInOut,duration:n.transitions.duration.shorter}),"&.Mui-focused":{width:400,boxShadow:200},"& fieldset":{borderWidth:"1px !important",borderColor:"0px 5px 6px -3px alpha(color, 0.2),0px 9px 12px 1px alpha(color, 0.14),0px 3px 16px 2px alpha(color, 0.12) !important"}}}));function x(e){var n=e.filterName,t=e.onFilterName;return(0,h.jsx)(p,{children:(0,h.jsx)(f,{value:n,onChange:t,type:"number",placeholder:"Search serial...",startAdornment:(0,h.jsx)(u.Z,{position:"start",children:(0,h.jsx)(d.Z,{})})})})}var m=t(28342),Z=t(4942),g=t(1413),j=t(61889),v=t(36151),b=t(40254),_=t(5289),C=t(97123),y=t(39157),S=t(65661),k=t(53767),w=t(93044),P=t(74569),N=t.n(P),R=t(74453),I=t(6278),W=t(85523),q=t(94454);var E=function(e){var n=e.open,t=e.account,l=e.handleClose,o=(0,s.useState)({serial:t.serial,first_name:t.first_name,last_name:t.last_name,middle_name:t.middle_name,section:t.section,parent_email:t.parent_email}),c=(0,i.Z)(o,2),u=c[0],d=c[1],p=(0,s.useState)(),f=(0,i.Z)(p,2),x=f[0],m=f[1],P=(0,s.useState)(null),E=(0,i.Z)(P,2),F=E[0],L=E[1],A=(0,s.useState)(),D=(0,i.Z)(A,2),G=D[0],M=D[1],O=u.serial,z=u.first_name,J=u.last_name,T=u.middle_name,U=u.section,V=u.parent_email;s.useEffect((function(){d((function(e){return{serial:t.serial,first_name:t.first_name,last_name:t.last_name,middle_name:t.middle_name,section:t.section,parent_email:t.parent_email}})),M(t.photo_url)}),[t]),s.useEffect((function(){if(null!==F){var e=new FileReader;e.readAsDataURL(F),e.onloadend=function(n){M([e.result])}}}),[F]);var Y=function(e){return d((0,g.Z)((0,g.Z)({},u),{},(0,Z.Z)({},e.target.name,e.target.value)))},B=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!F){e.next=7;break}return n=(0,R.iH)(I.IG,"profiles/"+F.name),e.next=4,(0,R.KV)(n,F);case 4:return e.next=6,(0,R.Jt)(n);case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,B();case 3:((a=e.sent)||t.photo_url)&&N().post("".concat("https://qrattendace.herokuapp.com","/students/update"),JSON.stringify({first_name:z,last_name:J,middle_name:T,section:U,serial:t.serial,photo_url:a||void 0,parent_email:V}),{headers:{"Content-Type":"application/json"}}).then((function(e){d({serial:"",first_name:"",last_name:"",middle_name:"",section:"",parent_email:""}),m(void 0),l()})).catch((function(e){console.log(e),m("Please check your Internet connection and try again.")}));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,h.jsx)(_.Z,{open:n,onClose:l,children:(0,h.jsxs)("form",{onSubmit:H,children:[(0,h.jsx)(S.Z,{children:"Update"}),(0,h.jsx)(y.Z,{children:(0,h.jsxs)(j.ZP,{container:!0,spacing:2,mt:3,children:[(0,h.jsx)(j.ZP,{item:!0,xs:12,sm:6,children:(0,h.jsxs)(k.Z,{direction:"column",justifyContent:"center",alignItems:"center",spacing:2,children:[(0,h.jsx)(b.Z,{autoFocus:!0,name:"serial",label:"Serial Number",value:O,onChange:Y,fullWidth:!0,variant:"outlined",required:!0}),(0,h.jsx)(b.Z,{name:"first_name",label:"First Name",value:z,onChange:Y,inputProps:{maxLength:20},fullWidth:!0,variant:"outlined",required:!0})]})}),(0,h.jsx)(j.ZP,{item:!0,xs:12,sm:6,children:(0,h.jsxs)(k.Z,{justifyContent:"center",alignItems:"center",spacing:2,children:[(0,h.jsx)(w.Z,{src:G,sx:{height:90,width:90,cursor:"pointer"},children:"NA"}),(0,h.jsxs)(v.Z,{variant:"outlined",size:"small",component:"label",children:["Change Image",(0,h.jsx)("input",{type:"file",accept:"image/png, image/jpeg, image/jpg",onChange:function(e){e.target.files&&L(e.target.files[0])},hidden:!0})]})]})}),(0,h.jsx)(j.ZP,{item:!0,xs:12,sm:6,children:(0,h.jsx)(b.Z,{name:"middle_name",label:"Middle Name",value:T,inputProps:{maxLength:20},onChange:Y,fullWidth:!0,variant:"outlined",required:!0})}),(0,h.jsx)(j.ZP,{item:!0,xs:12,sm:6,children:(0,h.jsx)(b.Z,{name:"section",label:"Grade & Section",value:U,placeholder:"Grade-Section",onChange:Y,inputProps:{maxLength:12},fullWidth:!0,variant:"outlined",disabled:t.isStaff,required:!0})}),(0,h.jsx)(j.ZP,{item:!0,xs:12,sm:6,children:(0,h.jsx)(b.Z,{name:"last_name",label:"Last Name",value:J,inputProps:{maxLength:20},onChange:Y,fullWidth:!0,variant:"outlined",required:!0})}),(0,h.jsx)(j.ZP,{item:!0,xs:12,sm:6,children:(0,h.jsx)(b.Z,{name:"parent_email",label:"Parent Email",value:V,type:"email",onChange:Y,fullWidth:!0,variant:"outlined",required:!0,error:void 0!==x,helperText:x,disabled:t.isStaff})}),(0,h.jsx)(j.ZP,{item:!0,xs:12,children:(0,h.jsx)(W.Z,{control:(0,h.jsx)(q.Z,{checked:t.isStaff}),label:"School Staff"})})]})}),(0,h.jsxs)(C.Z,{children:[(0,h.jsx)(v.Z,{color:"error",onClick:l,children:"Cancel"}),(0,h.jsx)(v.Z,{type:"submit",children:"Update"})]})]})})},F=t(51691),L=t(1656);function A(e){var n=e.open,t=e.name,r=e.serial,a=e.handleClose;return(0,h.jsxs)(_.Z,{open:n,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,h.jsx)(S.Z,{id:"alert-dialog-title",children:"Are you sure you want to delete "+(0,L.I)(t)}),(0,h.jsx)(y.Z,{children:(0,h.jsx)(F.Z,{id:"alert-dialog-description",children:"Please keep in mind that by clicking 'Yes', all ".concat((0,L.I)(t),"'s logs will also be deleted and cannot be retrieved again.")})}),(0,h.jsxs)(C.Z,{children:[(0,h.jsx)(v.Z,{onClick:a,children:"Cancel"}),(0,h.jsx)(v.Z,{onClick:function(){N().post("".concat("https://qrattendace.herokuapp.com","/students/delete"),JSON.stringify({serial:r}),{headers:{"Content-Type":"application/json"}}).then((function(e){a()})).catch((function(e){return console.log(e)}))},autoFocus:!0,children:"Yes"})]})]})}var D=t(45987),G=t(13400),M=t(29823),O=t(80925);function z(){return(z=(0,a.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get("".concat("https://qrattendace.herokuapp.com","/serial/encrypt/").concat(n));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J=["children","onClose"],T=(0,l.ZP)(_.Z)((function(e){var n=e.theme;return{"& .MuiDialogContent-root":{padding:n.spacing(2)},"& .MuiDialogActions-root":{padding:n.spacing(1)}}})),U=function(e){var n=e.children,t=e.onClose,r=(0,D.Z)(e,J);return(0,h.jsxs)(S.Z,(0,g.Z)((0,g.Z)({sx:{m:0,p:2}},r),{},{children:[n,t?(0,h.jsx)(G.Z,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.grey[500]}},children:(0,h.jsx)(M.Z,{})}):null]}))};function V(e){var n=e.open,t=e.value,r=e.handleClose,a=s.useState(),l=(0,i.Z)(a,2),o=l[0],c=l[1];return s.useEffect((function(){(function(e){return z.apply(this,arguments)})(t).then((function(e){return c(e.encrypted)})).catch((function(e){return console.error(e)}))}),[t]),(0,h.jsxs)(T,{onClose:r,"aria-labelledby":"customized-dialog-title",open:n,children:[(0,h.jsx)(U,{id:"customized-dialog-title",onClose:r,children:"Encrypted QRCode"}),(0,h.jsx)(y.Z,{dividers:!0,children:o&&(0,h.jsx)(O.Z,{value:o})}),(0,h.jsx)(C.Z,{children:(0,h.jsx)(v.Z,{autoFocus:!0,onClick:r,children:"Okay"})})]})}var Y=t(64554),B=t(20890),H=t(57621),K=t(39281),Q=t(79836),X=t(35855),$=t(53382),ee=t(53994),ne=t(63033),te=t(82477),re=t(29686),ae=t(41286),ie=t(27247),se=t(11542),le=[{id:"avatar",label:"",alignRight:!1},{id:"first_name",label:"First Name",alignRight:!1},{id:"middle_name",label:"Middle Name.",alignRight:!1},{id:"last_name",label:"Last Name",alignRight:!1},{id:"student_id",label:"Serial No.",alignRight:!1},{id:"course",label:"Grade & Section",alignRight:!1},{id:"role",label:"Role",alignRight:!1},{id:"options",label:"",alignRight:!0}];function oe(){var e=(0,s.useState)([]),n=(0,i.Z)(e,2),t=n[0],l=n[1],o=(0,s.useState)([]),c=(0,i.Z)(o,2),u=c[0],d=c[1],p=(0,s.useState)(5),f=(0,i.Z)(p,2),Z=f[0],g=f[1],j=(0,s.useState)(0),v=(0,i.Z)(j,2),b=v[0],_=v[1],C=(0,s.useState)(!1),y=(0,i.Z)(C,2),S=y[0],P=y[1],N=(0,s.useState)(),R=(0,i.Z)(N,2),I=R[0],W=R[1],q=(0,s.useState)(""),F=(0,i.Z)(q,2),D=F[0],M=F[1],O=(0,s.useState)(!1),z=(0,i.Z)(O,2),J=z[0],T=z[1],U=(0,s.useState)(!1),oe=(0,i.Z)(U,2),ce=oe[0],ue=oe[1];(0,s.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,re.lV)();case 3:n=e.sent,l((function(e){return n})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,s.useEffect)((function(){d((function(e){return t.filter((function(e){return e.serial.includes(D)})).slice(b*Z,b*Z+Z)}))}),[Z,b,t,D]);var de=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!1),T(!1),e.prev=2,e.next=5,(0,re.lV)();case 5:n=e.sent,l(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}();return(0,h.jsxs)(H.Z,{sx:{p:2},children:[(0,h.jsx)(x,{filterName:D,onFilterName:function(e){return M(e.target.value)}}),(0,h.jsx)(Y.Z,{sx:{overflowX:"auto"},children:(0,h.jsx)(K.Z,{sx:{minWidth:1e3},children:(0,h.jsxs)(Q.Z,{children:[(0,h.jsx)(m.Z,{orderBy:"name",order:"asc",headLabel:le,onRequestSort:function(e){}}),(0,h.jsx)($.Z,{children:u.map((function(e){return(0,h.jsxs)(X.Z,{hover:!0,tabIndex:-1,role:"checkbox",children:[(0,h.jsx)(ee.Z,{padding:"checkbox",children:(0,h.jsx)(w.Z,{alt:"profile",src:e.photo_url})}),(0,h.jsx)(ee.Z,{component:"th",scope:"row",children:(0,h.jsx)(B.Z,{variant:"subtitle2",noWrap:!0,children:(0,L.I)(e.first_name)})}),(0,h.jsx)(ee.Z,{component:"th",scope:"row",children:(0,h.jsx)(B.Z,{variant:"subtitle2",noWrap:!0,children:(0,L.I)(e.middle_name)})}),(0,h.jsx)(ee.Z,{component:"th",scope:"row",children:(0,h.jsx)(B.Z,{variant:"subtitle2",noWrap:!0,children:(0,L.I)(e.last_name)})}),(0,h.jsx)(ee.Z,{align:"left",children:e.serial}),(0,h.jsx)(ee.Z,{align:"left",children:e.section}),(0,h.jsx)(ee.Z,{align:"left",children:e.isStaff?"Staff":"Student"}),(0,h.jsx)(ee.Z,{align:"right",children:(0,h.jsxs)(k.Z,{direction:"row",justifyContent:"flex-end",children:[(0,h.jsx)(G.Z,{color:"info",onClick:function(){return W(e),void ue(!0)},children:(0,h.jsx)(te.Z,{title:"Generate",children:(0,h.jsx)(se.Z,{})})}),(0,h.jsx)(G.Z,{color:"info",onClick:function(){return W(e),void P(!0)},children:(0,h.jsx)(te.Z,{title:"Edit",children:(0,h.jsx)(ae.Z,{})})}),(0,h.jsx)(G.Z,{color:"error",onClick:function(){return W(e),void T(!0)},children:(0,h.jsx)(te.Z,{title:"Delete",children:(0,h.jsx)(ie.Z,{})})})]})})]},e.serial)}))})]})})}),(0,h.jsx)(ne.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:t.length,rowsPerPage:Z,page:b,onPageChange:function(e,n){return _(n)},onRowsPerPageChange:function(e){g(parseInt(e.target.value,10)),_(0)}}),I&&(0,h.jsx)(V,{value:I.serial,open:ce,handleClose:function(){return ue(!1)}}),I&&(0,h.jsx)(E,{account:I,open:S,handleClose:de}),I&&(0,h.jsx)(A,{name:I.first_name+" "+I.last_name,serial:I.serial,open:J,handleClose:de})]})}}}]);
//# sourceMappingURL=358.d906cc73.chunk.js.map